@page "/signup"
@layout MainLayout

@using DexQuiz.Client.Features.Authentication

@inject IJSRuntime JsRuntime

@inherits BlazorStateComponent

<div class="bg-image login">
    <div class="container-md d-flex">
        <div class="col-12 my-auto">
            <EditForm Model="@signUpData" OnValidSubmit="HandleLogin">
                <DataAnnotationsValidator />
                <div class="row mt-4">
                    <div class="col-10 offset-1 col-sm-8 offset-sm-2 col-md-6 offset-md-3 col-lg-4 offset-lg-4 text-center">
                        <img src="/images/logo-devcamp.png" style="max-width: 273px;" />
                    </div>
                </div>
                <div class="row mt-2 mt-md-5">
                    <div class="col-10 offset-1 col-sm-8 offset-sm-2 col-md-6 offset-md-3 col-lg-4 offset-lg-4 text-center">
                        <h5 class="text-white">teste seus conhecimentos</h5>
                    </div>
                </div>
                <div class="row mt-1 mt-md-3">
                    <div class="col-10 offset-1 col-sm-8 offset-sm-2 col-md-6 offset-md-3 col-lg-4 offset-lg-4">
                        <div class="form-group">
                            <label for="inputName">nome</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="email-span">
                                        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-envelope" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2zm13 2.383l-4.758 2.855L15 11.114v-5.73zm-.034 6.878L9.271 8.82 8 9.583 6.728 8.82l-5.694 3.44A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.739zM1 11.114l4.758-2.876L1 5.383v5.73z" />
                                        </svg>
                                    </span>
                                </div>
                                <InputText id="inputName" @bind-Value="signUpData.Name" class="form-control" placeholder="nome completo" aria-label="Nome Completo" aria-describedby="nome completo"
                                           disabled="@State.IsLoading" />
                            </div>
                            <ValidationMessage For="@(() => signUpData.Name)" />
                        </div>
                        <div class="form-group">
                            <label for="inputPhoneNumber">celular</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="password-span">
                                        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-key" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M0 8a4 4 0 0 1 7.465-2H14a.5.5 0 0 1 .354.146l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0L13 9.207l-.646.647a.5.5 0 0 1-.708 0L11 9.207l-.646.647a.5.5 0 0 1-.708 0L9 9.207l-.646.647A.5.5 0 0 1 8 10h-.535A4 4 0 0 1 0 8zm4-3a3 3 0 1 0 2.712 4.285A.5.5 0 0 1 7.163 9h.63l.853-.854a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.793-.793-1-1h-6.63a.5.5 0 0 1-.451-.285A3 3 0 0 0 4 5z" />
                                            <path d="M4 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0z" />
                                        </svg>
                                    </span>
                                </div>
                                <InputNumber id="inputPhoneNumber" @bind-Value="signUpData.CellPhone" class="form-control" placeholder="11988887777" aria-label="Celular" aria-describedby="celular"
                                             disabled="@State.IsLoading" />
                            </div>
                            <ValidationMessage For="@(() => signUpData.CellPhone)" />
                        </div>
                        <div class="form-group">
                            <label for="inputEmail">e-mail</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="email-span">
                                        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-envelope" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2zm13 2.383l-4.758 2.855L15 11.114v-5.73zm-.034 6.878L9.271 8.82 8 9.583 6.728 8.82l-5.694 3.44A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.739zM1 11.114l4.758-2.876L1 5.383v5.73z" />
                                        </svg>
                                    </span>
                                </div>
                                <InputText id="inputEmail" @bind-Value="signUpData.Email" class="form-control" placeholder="usuario@dominio.com" aria-label="E-mail" aria-describedby="email"
                                           disabled="@State.IsLoading" />
                            </div>
                            <ValidationMessage For="@(() => signUpData.Email)" />
                        </div>
                        <div class="form-group">
                            <label for="inputEmail">linkedin</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="email-span">
                                        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-envelope" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2zm13 2.383l-4.758 2.855L15 11.114v-5.73zm-.034 6.878L9.271 8.82 8 9.583 6.728 8.82l-5.694 3.44A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.739zM1 11.114l4.758-2.876L1 5.383v5.73z" />
                                        </svg>
                                    </span>
                                </div>
                                <InputText id="inputLinkedin" @bind-Value="signUpData.Linkedin" class="form-control" placeholder="https://www.linkedin.com/in/usuario" aria-label="E-mail" aria-describedby="email"
                                           disabled="@State.IsLoading" />
                            </div>
                            <ValidationMessage For="@(() => signUpData.Linkedin)" />
                        </div>
                        <div class="form-group">
                            <label for="inputPassword">senha</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="password-span">
                                        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-key" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M0 8a4 4 0 0 1 7.465-2H14a.5.5 0 0 1 .354.146l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0L13 9.207l-.646.647a.5.5 0 0 1-.708 0L11 9.207l-.646.647a.5.5 0 0 1-.708 0L9 9.207l-.646.647A.5.5 0 0 1 8 10h-.535A4 4 0 0 1 0 8zm4-3a3 3 0 1 0 2.712 4.285A.5.5 0 0 1 7.163 9h.63l.853-.854a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.793-.793-1-1h-6.63a.5.5 0 0 1-.451-.285A3 3 0 0 0 4 5z" />
                                            <path d="M4 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0z" />
                                        </svg>
                                    </span>
                                </div>
                                <InputText id="inputPassword" type="@(showPassword ? "text" : "password")" @bind-Value="signUpData.Password" class="form-control" placeholder="insira sua senha" aria-label="Password" aria-describedby="password"
                                           disabled="@State.IsLoading" />
                                <div class="input-group-append">
                                    <span class="input-group-text" @onclick="TogglePassword" style="cursor: pointer;">
                                        @if (showPassword)
                                        {
                                            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-eye-slash" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M13.359 11.238C15.06 9.72 16 8 16 8s-3-5.5-8-5.5a7.028 7.028 0 0 0-2.79.588l.77.771A5.944 5.944 0 0 1 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.134 13.134 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755-.165.165-.337.328-.517.486l.708.709z" />
                                                <path d="M11.297 9.176a3.5 3.5 0 0 0-4.474-4.474l.823.823a2.5 2.5 0 0 1 2.829 2.829l.822.822zm-2.943 1.299l.822.822a3.5 3.5 0 0 1-4.474-4.474l.823.823a2.5 2.5 0 0 0 2.829 2.829z" />
                                                <path d="M3.35 5.47c-.18.16-.353.322-.518.487A13.134 13.134 0 0 0 1.172 8l.195.288c.335.48.83 1.12 1.465 1.755C4.121 11.332 5.881 12.5 8 12.5c.716 0 1.39-.133 2.02-.36l.77.772A7.029 7.029 0 0 1 8 13.5C3 13.5 0 8 0 8s.939-1.721 2.641-3.238l.708.709z" />
                                                <path fill-rule="evenodd" d="M13.646 14.354l-12-12 .708-.708 12 12-.708.708z" />
                                            </svg>
                                        }
                                        else
                                        {
                                            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-eye" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                                <path fill-rule="evenodd" d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.134 13.134 0 0 0 1.66 2.043C4.12 11.332 5.88 12.5 8 12.5c2.12 0 3.879-1.168 5.168-2.457A13.134 13.134 0 0 0 14.828 8a13.133 13.133 0 0 0-1.66-2.043C11.879 4.668 10.119 3.5 8 3.5c-2.12 0-3.879 1.168-5.168 2.457A13.133 13.133 0 0 0 1.172 8z" />
                                                <path fill-rule="evenodd" d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z" />
                                            </svg>
                                        }
                                    </span>
                                </div>
                            </div>
                            <ValidationMessage For="@(() => signUpData.Password)" />
                        </div>
                        <div class="form-group mt-4">
                            <label class="checkscript">
                                aceito receber e-mails da Dextra
                                <InputCheckbox id="inputCheckEmail" @bind-Value="signUpData.AllowContact" class="form-control" aria-label="Aceito receber e-mails" aria-describedby="aceito receber emails"
                                               disabled="@State.IsLoading" />
                                <span class="checkmark"></span>
                            </label>
                        </div>
                    </div>
                </div>
                <div class="row mt-1 mt-md-2">
                    <div class="col-10 offset-1 col-sm-8 offset-sm-2 col-md-6 offset-md-3 col-lg-4 offset-lg-4 text-center">
                        <button type="button" id="back-login" class="nav-link link-button d-inline" @onclick="ShowLegalTerms">
                            Pol&iacute;tica de privacidade
                        </button>
                    </div>
                </div>
                <div class="row mt-2 mt-md-3">
                    <div class="col-10 offset-1 col-sm-8 offset-sm-2 col-md-6 offset-md-3 col-lg-4 offset-lg-4">
                        <button class="btn btn-light w-100" type="submit">
                            @if (State.IsLoading)
                            {
                                <svg xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.0" width="158px" height="24px" viewBox="0 0 158 24" xml:space="preserve"><path fill="#e3e3e3" d="M64 4h10v10H64V4zm20 0h10v10H84V4zm20 0h10v10h-10V4zm20 0h10v10h-10V4zm20 0h10v10h-10V4zM4 4h10v10H4V4zm20 0h10v10H24V4zm20 0h10v10H44V4z" /><path fill="#bdbdbd" d="M144 14V4h10v10h-10zm9-9h-8v8h8V5zm-29 9V4h10v10h-10zm9-9h-8v8h8V5zm-29 9V4h10v10h-10zm9-9h-8v8h8V5zm-29 9V4h10v10H84zm9-9h-8v8h8V5zm-29 9V4h10v10H64zm9-9h-8v8h8V5zm-29 9V4h10v10H44zm9-9h-8v8h8V5zm-29 9V4h10v10H24zm9-9h-8v8h8V5zM4 14V4h10v10H4zm9-9H5v8h8V5z" /><g><path fill="#d9d9d9" d="M-58 16V2h14v14h-14zm13-13h-12v12h12V3z" /><path fill="#9c9c9c" fill-opacity="0.3" d="M-40 0h18v18h-18z" /><path fill="#b2b2b2" d="M-40 18V0h18v18h-18zm17-17h-16v16h16V1z" /><path fill="#9c9c9c" fill-opacity="0.7" d="M-20 0h18v18h-18z" /><path fill="#4c4c4c" d="M-20 18V0h18v18h-18zM-3 1h-16v16h16V1z" /><animateTransform attributeName="transform" type="translate" values="20 0;40 0;60 0;80 0;100 0;120 0;140 0;160 0;180 0;200 0" calcMode="discrete" dur="1800ms" repeatCount="indefinite" /></g></svg>
                            }
                            else
                            {
                                <text>CADASTRAR</text>
                            }
                        </button>
                    </div>
                </div>
                <div class="row mt-1 mt-md-2">
                    <div class="col-10 offset-1 col-sm-8 offset-sm-2 col-md-6 offset-md-3 col-lg-4 offset-lg-4 text-center">
                        <NavLink id="back-login" class="nav-link" href="login">
                            Voltar
                        </NavLink>
                    </div>
                </div>
                <div class="row mt-5 mb-3 mb-sm-4 mb-md-5">
                    <div class="col-6 col-sm-4 offset-sm-2 col-md-2 offset-md-4 text-center">
                        <img src="/images/logo-dextra-negativo-branco-new.png" />
                    </div>
                    <div class="col-6 col-sm-4 col-md-2 text-center">
                        <img src="/images/logo-mutant-negativo-branco-new.png" />
                    </div>
                </div>
            </EditForm>
        </div>
    </div>
</div>

<LegalTerms Open="@legalTermsOpen" OnClose="@CloseLegalTerms" />

@code {
    private bool showPassword = false;

    private UserModel signUpData = new UserModel();

    private bool legalTermsOpen;

    AuthState State => GetState<AuthState>();

    private void TogglePassword()
    {
        showPassword = !showPassword;
    }

    private void HandleLogin()
    {
        Mediator.Send(new AuthState.SignUpAction(signUpData));
    }

    private void ShowLegalTerms()
    {
        legalTermsOpen = true;
    }

    private void CloseLegalTerms(MouseEventArgs e)
    {
        legalTermsOpen = false;
    }
}